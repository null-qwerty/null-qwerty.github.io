---
title: 理解贝叶斯定理
date: 2023-10-10 16:05:11
tags:
- 数学
- 概率论与数理统计
mathjax: true
excerpt: 对贝叶斯定理的理解
---

首先贴一下百度百科上贝叶斯定理的简介：

> 贝叶斯定理由英国数学家贝叶斯 ( Thomas Bayes 1702-1761 ) 发展，用来描述两个条件概率之间的关系，比如 $P(A|B)$ 和 $P(B|A)$。按照乘法法则，可以立刻导出
>
> $$
> P(A \cap B) = P(A) \times P(B|A)=P(B) \times P(A|B)
> $$
>
> 如上公式也可变形为
>
> $$
> P(A|B)=P(B|A) \times \frac{P(A)}{P(B)} \qquad (I)
> $$

## 什么是贝叶斯定理

在贝叶斯定理之前，我们先来认识全概率公式：

> 设 $B_1,B_2,\cdots,B_n$ 是样本空间 $S$ 的一个划分，且 $P(B_i)>0(i=1,2,\cdots,n)$，则对 $S$ 的任一事件 $A$，有
>
> $$
> A=AS=A(B_1 \cup B_2 \cup \cdots \cup B_n)
> $$
>
> 假设$P(B_i)>0(i=1,2,\cdots,n)$，有
>
> $$
> P(A)=P(AB_1)+P(AB_2)+\cdots+P(AB_n)
> $$
>
> 根据乘法定理，上式可改写为
>
> $$
> P(A)=P(A|B_1)P(B_1)+P(A|B_2)P(B_2)+\cdots+P(A|B_n)P(B_n)\qquad(*)
> $$
>
> $(*)$式被称为 **全概率公式**.

根据全概率公式和条件概率的定义，可以推出贝叶斯定理：

$$
P(B_i|A)=\frac{P(A|B_i)P(B_i)}{\sum_{j=1}^{n}P(A|B_j)P(B_j)}, i=1,2,\cdots,n
$$

即$P(B_i|A)=P(A|B_i) \times \frac{P(B_i)}{P(A)}, i=1,2,\cdots,n$

在贝叶斯定理【$(I)$式】中，每个名词都有约定俗成的名称：
$P(A)$是$A$的**先验概率**或边缘概率。之所以称为"先验"是因为它不考虑任何$B$方面的因素。
$P(A|B)$是已知$B$发生后$A$的条件概率，也由于得自$B$的取值而被称作$A$的**后验概率**。
$P(B|A)$是已知$A$发生后$B$的条件概率，也由于得自$A$的取值而被称作$B$的**后验概率**。
$P(B)$是$B$的先验概率或边缘概率，也作**标准化常量（normalized constant）**。 
用这些术语，贝叶斯定理可以表述为：
$后验概率=\frac{(相似度 \times 先验概率)}{标准化常量}$
> 其中的相似度指$P(B|A)$，比例$\frac{相似度}{标准化常量}$被称为**标准相似度**，或**可能性函数**，由此贝叶斯定理可以表示为：
> $后验概率=标准相似度(可能性函数) \times 先验概率$
>
>> 可能性函数是一个调整因子，也就是新信息$B$带来的调整，作用是将先验概率调整到更接近真实概率。
>> 
>> $可能性函数>1$，表明新信息$B$增强了$A$的真实性。
>> $可能性函数=1$，表明新信息$B$对$A$的真实性没有影响。
>> $可能性函数<1$，表明新信息$B$减弱了$A$的真实性。

## 贝叶斯定理能做什么

### 逆概率问题

贝叶斯定理的产生是为了计算“逆概率”问题，比如：
> 已知某疾病患病概率为$0.1\%$，某检测方法的准确率为$95\%$，误报率为$0.4\%$，某人检测结果为阳性，求该人患病的概率。

设$A$为患病，$B$为检测结果为阳性，则：
$$P(A)=0.001,P(B|A)=0.95$$
$$P(B)=P(B|A)P(A)+P(B|\bar{A})P(\bar{A})=0.95 \times 0.001 + 0.004 \times 0.999=0.004946$$
于是我们得到：
$$P(A|B)=\frac{P(B|A)P(A)}{P(B)}=\frac{0.95 \times 0.001}{0.004946}=0.192$$
即该人患病的概率约为$19.2\%$。 
这也是检测患病人群要多次检测的原因。

### 机器学习中的应用

贝叶斯定理是一种**推理**方法，**它与人脑的工作机制很像，这一特征让贝叶斯定理成为机器学习的基础**。

贝叶斯定理的性质，使得它能够将**先验知识**和**新证据**结合起来，形成**新的知识**，这让它对于那些需要在庞大数据库中进行数据匹配的问题非常有效。

例如，我们可以用贝叶斯定理来进行垃圾邮件的过滤。我们可以先从大量的邮件中学习出一些关键词，比如“药物”、“银行”、“免费”、“领奖”等等，然后根据这些关键词来判断一封邮件是否是垃圾邮件。这里，关键词就是先验知识，而新邮件中是否包含这些关键词就是新证据，我们可以根据贝叶斯定理来计算一封邮件是垃圾邮件的概率。

或者制作一个[拼写检查器](http://norvig.com/spell-correct.html)。